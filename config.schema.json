{
  "pluginAlias": "BlinkCameras",
  "pluginType": "platform",
  "singular": true,
  "headerDisplay": "Blink cameras integration for HomeKit via Homebridge. Provides SecuritySystem arm/disarm, motion sensors, and doorbell notifications.",
  "footerDisplay": "For help, see the [README](https://github.com/sealad886/homebridge-blink-cameras-new-api#readme).",
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Platform Name",
        "description": "Name for this Blink platform instance",
        "type": "string",
        "default": "Blink",
        "required": true
      },
      "username": {
        "title": "Blink Account Email",
        "description": "Your Blink account email address",
        "type": "string",
        "format": "email",
        "required": true
      },
      "password": {
        "title": "Blink Account Password",
        "description": "Your Blink account password",
        "type": "string",
        "required": true
      },
      "deviceId": {
        "title": "Device ID",
        "description": "Unique identifier for this Homebridge instance (sent to Blink as hardware_id)",
        "type": "string",
        "default": "homebridge-blink",
        "required": false
      },
      "deviceName": {
        "title": "Device Name",
        "description": "Friendly name for this device (fallback for Device ID)",
        "type": "string",
        "required": false
      },
      "twoFactorCode": {
        "title": "Two-Factor Code",
        "description": "2FA code for initial login. Only needed if Blink sends a verification code. Remove after successful login.",
        "type": "string",
        "required": false
      },
      "clientVerificationCode": {
        "title": "Client Verification Code",
        "description": "Verification code sent for new device approval. Only needed if Blink asks to verify this client. Remove after successful verification.",
        "type": "string",
        "required": false
      },
      "accountVerificationCode": {
        "title": "Account Verification Code",
        "description": "Verification code sent for account/phone verification. Only needed if Blink requests account verification. Remove after successful verification.",
        "type": "string",
        "required": false
      },
      "tier": {
        "title": "Blink Environment",
        "description": "Blink API environment tier. Use 'prod' for production (default). Numeric tiers like 'e006' are region-specific production endpoints.",
        "type": "string",
        "default": "prod",
        "required": false,
        "oneOf": [
          { "title": "Production", "enum": ["prod"] },
          { "title": "Production (e001)", "enum": ["e001"] },
          { "title": "Production (e002)", "enum": ["e002"] },
          { "title": "Production (e003)", "enum": ["e003"] },
          { "title": "Production (e004)", "enum": ["e004"] },
          { "title": "Production (e005)", "enum": ["e005"] },
          { "title": "Production (e006)", "enum": ["e006"] },
          { "title": "Staging (SQA1)", "enum": ["sqa1"] },
          { "title": "CEMP", "enum": ["cemp"] },
          { "title": "Production (EU)", "enum": ["prde"] },
          { "title": "Production (APAC)", "enum": ["prsg"] },
          { "title": "Production (AU)", "enum": ["a001"] },
          { "title": "SRF1", "enum": ["srf1"] }
        ]
      },
      "sharedTier": {
        "title": "Blink Shared Tier",
        "description": "Override shared REST tier (rest-{shared_tier}); defaults to tier when unset.",
        "type": "string",
        "required": false,
        "oneOf": [
          { "title": "Production", "enum": ["prod"] },
          { "title": "Staging (SQA1)", "enum": ["sqa1"] },
          { "title": "CEMP", "enum": ["cemp"] },
          { "title": "Production (EU)", "enum": ["prde"] },
          { "title": "Production (APAC)", "enum": ["prsg"] },
          { "title": "Production (AU)", "enum": ["a001"] },
          { "title": "SRF1", "enum": ["srf1"] }
        ]
      },
      "debugAuth": {
        "title": "Debug Authentication",
        "description": "Enable verbose diagnostic logging for Blink API authentication. Useful for troubleshooting login failures, token issues, and API errors. WARNING: May log sensitive request details.",
        "type": "boolean",
        "default": false,
        "required": false
      },
      "persistAuth": {
        "title": "Persist Auth Tokens",
        "description": "Persist OAuth tokens across restarts to avoid repeated logins and verification prompts.",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "trustDevice": {
        "title": "Trust This Device",
        "description": "Mark this Homebridge instance as a trusted device during client verification.",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "pollInterval": {
        "title": "Poll Interval (seconds)",
        "description": "How often to poll Blink for state changes. Minimum 15 seconds.",
        "type": "integer",
        "default": 60,
        "minimum": 15,
        "maximum": 600,
        "required": false
      },
      "motionTimeout": {
        "title": "Motion Timeout (seconds)",
        "description": "How long motion detected state stays active before resetting",
        "type": "integer",
        "default": 30,
        "minimum": 5,
        "maximum": 300,
        "required": false
      },
      "enableMotionPolling": {
        "title": "Enable Motion Detection",
        "description": "Poll for motion events via media API. Disable to reduce API calls.",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "enableStreaming": {
        "title": "Enable Live Streaming",
        "description": "Enable HomeKit live video streaming via FFmpeg.",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "ffmpegPath": {
        "title": "FFmpeg Path",
        "description": "Path to the FFmpeg binary. Defaults to ffmpeg in PATH.",
        "type": "string",
        "default": "ffmpeg",
        "required": false
      },
      "ffmpegDebug": {
        "title": "FFmpeg Debug Logging",
        "description": "Log FFmpeg output for troubleshooting.",
        "type": "boolean",
        "default": false,
        "required": false
      },
      "debugStreamPath": {
        "title": "Debug Stream Recording Path",
        "description": "Path to save raw MPEG-TS stream recordings for debugging. Leave empty to disable. Files are saved as blink-stream-{serial}-{timestamp}.ts",
        "type": "string",
        "required": false,
        "placeholder": "/tmp/blink-streams"
      },
      "snapshotCacheTTL": {
        "title": "Snapshot Cache Duration (seconds)",
        "description": "How long to cache camera snapshots before requesting a fresh one from Blink. Set to 0 to always request fresh snapshots (uses more battery). Default: 60 seconds.",
        "type": "integer",
        "default": 60,
        "minimum": 0,
        "maximum": 300,
        "required": false
      },
      "rtspTransport": {
        "title": "RTSP Transport",
        "description": "RTSP transport mode for Blink live view input.",
        "type": "string",
        "default": "tcp",
        "required": false,
        "oneOf": [
          { "title": "TCP (recommended)", "enum": ["tcp"] },
          { "title": "UDP", "enum": ["udp"] }
        ]
      },
      "maxStreams": {
        "title": "Max Concurrent Streams",
        "description": "Maximum number of simultaneous HomeKit streams.",
        "type": "integer",
        "default": 1,
        "minimum": 1,
        "maximum": 4,
        "required": false
      },
      "enableAudio": {
        "title": "Enable Audio",
        "description": "Enable audio streaming from camera to HomeKit.",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "twoWayAudio": {
        "title": "Enable Two-Way Audio",
        "description": "Enable talkback audio from HomeKit to the camera (requires audio enabled).",
        "type": "boolean",
        "default": true,
        "required": false
      },
      "audioCodec": {
        "title": "Audio Codec",
        "description": "Preferred audio codec for HomeKit streaming.",
        "type": "string",
        "default": "opus",
        "required": false,
        "oneOf": [
          { "title": "Opus (recommended)", "enum": ["opus"] },
          { "title": "AAC-ELD", "enum": ["aac-eld"] },
          { "title": "PCMA", "enum": ["pcma"] },
          { "title": "PCMU", "enum": ["pcmu"] }
        ]
      },
      "audioBitrate": {
        "title": "Audio Bitrate (kbps)",
        "description": "Target audio bitrate for HomeKit streaming.",
        "type": "integer",
        "default": 32,
        "minimum": 8,
        "maximum": 128,
        "required": false
      },
      "videoBitrate": {
        "title": "Max Video Bitrate (kbps)",
        "description": "Cap the video bitrate (leave empty to use HomeKit defaults).",
        "type": "integer",
        "minimum": 300,
        "maximum": 8000,
        "required": false
      },
      "excludeDevices": {
        "title": "Excluded Devices",
        "description": "List of device serial numbers, IDs, or names to exclude from HomeKit. Useful for hiding devices you don't want to control.",
        "type": "array",
        "items": {
          "type": "string",
          "title": "Device Identifier"
        },
        "required": false
      },
      "deviceNames": {
        "title": "Custom Device Names",
        "description": "Override display names for devices in HomeKit. Key is the device serial number or ID, value is the custom name.",
        "type": "object",
        "additionalProperties": {
          "type": "string"
        },
        "required": false
      },
      "deviceSettings": {
        "title": "Per-Device Settings",
        "description": "Override settings for specific devices. Key is the device serial number or ID.",
        "type": "object",
        "additionalProperties": {
          "type": "object",
          "properties": {
            "motionTimeout": {
              "type": "integer",
              "minimum": 5,
              "maximum": 300,
              "description": "Motion timeout in seconds for this device"
            },
            "enableMotion": {
              "type": "boolean",
              "description": "Enable/disable motion detection for this device"
            }
          }
        },
        "required": false
      }
    }
  },
  "layout": [
    {
      "type": "fieldset",
      "title": "Account Settings",
      "items": [
        "name",
        "username",
        {
          "key": "password",
          "type": "password"
        },
        "twoFactorCode",
        "clientVerificationCode"
      ]
    },
    {
      "type": "fieldset",
      "title": "Device Identification",
      "expandable": true,
      "expanded": false,
      "items": [
        "deviceId",
        "deviceName"
      ]
    },
    {
      "type": "fieldset",
      "title": "Polling Settings",
      "expandable": true,
      "expanded": false,
      "items": [
        "pollInterval",
        "motionTimeout",
        "enableMotionPolling"
      ]
    },
    {
      "type": "fieldset",
      "title": "Streaming",
      "expandable": true,
      "expanded": false,
      "items": [
        "enableStreaming",
        "ffmpegPath",
        "ffmpegDebug",
        "rtspTransport",
        "maxStreams",
        "enableAudio",
        "twoWayAudio",
        "audioCodec",
        "audioBitrate",
        "videoBitrate"
      ]
    },
    {
      "type": "fieldset",
      "title": "Device Customization",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "key": "excludeDevices",
          "type": "array",
          "buttonText": "Add Device to Exclude"
        },
        "deviceNames",
        "deviceSettings"
      ]
    },
    {
      "type": "fieldset",
      "title": "Advanced",
      "expandable": true,
      "expanded": false,
      "items": [
        "tier",
        "debugAuth",
        "persistAuth",
        "trustDevice"
      ]
    }
  ]
}
